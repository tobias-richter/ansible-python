- name: Include distribution specific variables.
  ansible.builtin.include_vars: "{{ item }}"
  with_first_found:
    - "{{ ansible_distribution }}_{{ ansible_lsb.major_release }}.yml"
    - "{{ ansible_distribution }}.yml"
    - "default.yml"

- name: Install packages.
  ansible.builtin.package:
    name: "{{ python_os_packages }}"

- name: configure pip.
  ansible.builtin.template:
    src: "templates/etc/pip.conf.j2"
    dest: "/etc/pip.conf"
    mode: 0644
  when:
    - python_global_index_url is defined

- name: Update setuptools.
  ansible.builtin.pip:
    name: "{{ python_pip_package_setuptools }}"
    executable: pip3

- name: Update pip.
  ansible.builtin.pip:
    name: "{{ python_pip_package_pip }}"
    executable: pip3

- name: Install pip packages.
  ansible.builtin.pip:
    name: "{{ python_pip_packages }}"
    executable: pip3
